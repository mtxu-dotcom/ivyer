<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆèªé…å°æŒ‘æˆ°</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è¼‰å…¥ Tone.js ç”¨æ–¼èƒŒæ™¯éŸ³æ¨‚ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        /* è‡ªå®šç¾©å­—é«” */
        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }

        /* éŒ¯èª¤æ™‚çš„æ™ƒå‹•å‹•ç•« */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }
        .animate-shake {
            animation: shake 0.5s ease-in-out;
        }

        /* é¸ä¸­ç‹€æ…‹ */
        .selected {
            background-color: #bfdbfe; /* bg-blue-200 */
            border-color: #60a5fa; /* border-blue-400 */
            box-shadow: 0 0 0 2px #93c5fd; /* ring-2 ring-blue-300 */
        }
        
        /* é…å°æˆåŠŸç‹€æ…‹ */
        .matched {
            background-color: #d1fae5; /* bg-green-100 */
            border-color: #34d399; /* border-green-400 */
            color: #065f46; /* text-green-800 */
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* é…å°éŒ¯èª¤ç‹€æ…‹ */
        .wrong {
            background-color: #fee2e2; /* bg-red-100 */
            border-color: #f87171; /* border-red-400 */
            animation: shake 0.5s ease-in-out;
        }

        /* åˆ—è¡¨é …ç›®çš„åŸºæœ¬æ¨£å¼ */
        .game-card {
            padding: 1rem;
            border: 2px solid #e5e7eb; /* border-gray-200 */
            border-radius: 0.5rem; /* rounded-lg */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            text-align: center;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .game-card:not(.matched):hover {
            background-color: #f9fafb; /* hover:bg-gray-50 */
            border-color: #9ca3af; /* hover:border-gray-400 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div class="container max-w-6xl w-full mx-auto bg-white rounded-xl shadow-2xl p-6 md:p-10">
        
        <h1 class="text-3xl md:text-4xl font-bold text-center text-blue-700 mb-4">
            ğŸ§  æˆèªé…å°æŒ‘æˆ° ğŸ§ 
        </h1>
        <p class="text-center text-gray-600 mb-6">
            è«‹é»æ“Šå·¦é‚Šçš„æˆèªï¼Œå†é»æ“Šå³é‚Šå°æ‡‰çš„è§£é‡‹ã€‚
        </p>

        <!-- éŠæˆ²å€åŸŸ -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8">
            <!-- æ¬„ä½ä¸€ï¼šæˆèª -->
            <div class="border-4 border-blue-200 rounded-lg p-4">
                <h2 class="text-xl font-semibold text-center text-blue-800 mb-4">æˆèª</h2>
                <ul id="idiom-list" class="space-y-3">
                    <!-- æˆèªå°‡ç”± JavaScript å‹•æ…‹è¼‰å…¥ -->
                </ul>
            </div>

            <!-- æ¬„ä½äºŒï¼šè§£é‡‹ -->
            <div class="border-4 border-green-200 rounded-lg p-4">
                <h2 class="text-xl font-semibold text-center text-green-800 mb-4">è§£é‡‹</h2>
                <ul id="definition-list" class="space-y-3">
                    <!-- è§£é‡‹å°‡ç”± JavaScript å‹•æ…‹è¼‰å…¥ -->
                </ul>
            </div>
        </div>

        <!-- æ§åˆ¶æŒ‰éˆ• -->
        <div class="flex flex-col md:flex-row items-center justify-center gap-4 mt-8">
            <button id="music-btn" class="w-full md:w-auto bg-purple-600 text-white font-medium py-3 px-6 rounded-lg shadow-md hover:bg-purple-700 transition-all duration-200">
                ğŸµ æ’­æ”¾/åœæ­¢éŸ³æ¨‚
            </button>
            <button id="reset-btn" class="w-full md:w-auto bg-gray-500 text-white font-medium py-3 px-6 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200">
                ğŸ”„ é‡æ–°é–‹å§‹
            </button>
        </div>

    </div>

    <!-- çµæœå½ˆçª— (é è¨­éš±è—) -->
    <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden transition-opacity duration-300">
        <div class="bg-white rounded-lg shadow-xl p-8 md:p-12 text-center transform scale-95 transition-transform duration-300">
            <h2 class="text-4xl font-bold text-yellow-500 mb-4">ğŸ‰</h2>
            <h3 class="text-2xl font-semibold text-gray-800 mb-4">æ­å–œï¼å…¨éƒ¨é…å°æˆåŠŸï¼</h3>
            <p class="text-gray-600 mb-6">æ‚¨å·²å®Œæˆæ‰€æœ‰ 15 å€‹æˆèªé…å°ï¼</p>
            <button id="close-modal-btn" class="bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700 transition-all">
                å¤ªæ£’äº†ï¼
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. éŠæˆ²è³‡æ–™ ---
            const gameData = [
                { id: 1, idiom: "ä¸€ç›®åè¡Œ", definition: "å½¢å®¹é–±è®€é€Ÿåº¦ååˆ†å¿«é€Ÿã€‚" },
                { id: 2, idiom: "ç›®ä¸è­˜ä¸", definition: "æ¯”å–»ä¸è­˜å­—æˆ–æ¯«ç„¡å­¸å•ã€‚" },
                { id: 3, idiom: "è€³ç›®ä¸€æ–°", definition: "å½¢å®¹æ‰€è¦‹æ‰€èéƒ½æœ‰ä¸€ç¨®æ–°å¥‡ã€æ¸…æ–°çš„æ„Ÿè¦ºã€‚" },
                { id: 4, idiom: "ç›®ä¸è½‰ç›", definition: "çœ¼ç ä¸è½‰åœ°ç›¯è‘—çœ‹ï¼Œå½¢å®¹æ³¨æ„åŠ›é«˜åº¦é›†ä¸­ã€‚" },
                { id: 5, idiom: "çœ‰é–‹çœ¼ç¬‘", definition: "å½¢å®¹æ„‰æ‚…æ¬£å–œçš„ç¥æƒ…ã€‚" },
                { id: 6, idiom: "ç›®çªå£å‘†", definition: "å½¢å®¹å—é©šæˆ–å—çª˜ä»¥è‡´ç¥æƒ…å‘†æ»¯çš„æ¨£å­ã€‚" },
                { id: 7, idiom: "ç›®ä¸­ç„¡äºº", definition: "å½¢å®¹éå¸¸è‡ªå¤§ã€‚" },
                { id: 8, idiom: "è³å¿ƒæ‚…ç›®", definition: "å½¢å®¹æƒ…æ™¯å„ªç¾ï¼Œä½¿å¿ƒæƒ…éƒ½æ„Ÿåˆ°å¿«æ¨‚èˆ’æš¢ã€‚" },
                { id: 9, idiom: "å£èœœè…¹åŠ", definition: "æ¯”å–»ä¸€å€‹äººèªªå¾—å¥½è½ï¼Œå»å…§å¿ƒé™°éšªï¼Œè™•è™•æƒ³é™·å®³åˆ¥äººã€‚" },
                { id: 10, idiom: "ç•°å£åŒè²", definition: "ä¸åŒçš„äººèªªå‡ºåŒæ¨£çš„è©±ï¼Œå½¢å®¹äººå€‘çš„æ„è¦‹å®Œå…¨ä¸€è‡´ã€‚" },
                { id: 11, idiom: "ç¦å¾å£å‡º", definition: "æ¯”å–»èªªéŒ¯äº†è©±è¦æƒ¹ç¦ï¼Œå¼·èª¿è¨€èªå¿…é ˆè¬¹æ…ã€‚" },
                { id: 12, idiom: "å•å£ç„¡è¨€", definition: "å½¢å®¹é­äººè³ªå•æˆ–é§æ–¥æ™‚æ²‰é»˜ä¸èªæˆ–ç„¡è¨€ä»¥å°ã€‚" },
                { id: 13, idiom: "è‹¦å£å©†å¿ƒ", definition: "å½¢å®¹ä»¥æ‡‡åˆ‡çœŸæ‘¯çš„æ…‹åº¦ï¼Œç«­åŠ›å‹¸å‘Šä»–äººã€‚" },
                { id: 14, idiom: "å¿ƒå¹³æ°£å’Œ", definition: "å½¢å®¹å¿ƒæƒ…å¹³éœã€æ…‹åº¦æº«å’Œã€‚" },
                { id: 15, idiom: "å¿ƒæœå£æœ", definition: "å¿ƒè£å’Œå˜´ä¸Šéƒ½ä¿¡æœï¼Œå½¢å®¹çœŸå¿ƒæœæ°£æˆ–èªè¼¸ã€‚" }
            ];

            // --- 2. DOM å…ƒç´  ---
            const idiomList = document.getElementById('idiom-list');
            const definitionList = document.getElementById('definition-list');
            const resetBtn = document.getElementById('reset-btn');
            const musicBtn = document.getElementById('music-btn');
            const resultModal = document.getElementById('result-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');

            // --- 3. éŠæˆ²ç‹€æ…‹ ---
            let selectedIdiom = null;
            let selectedDefinition = null;
            let matchedCount = 0;
            const totalPairs = gameData.length;

            // --- 4. æ´—ç‰Œæ¼”ç®—æ³• (Fisher-Yates) ---
            function shuffle(array) {
                let currentIndex = array.length, randomIndex;
                while (currentIndex != 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [
                        array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            // --- 5. éŠæˆ²åˆå§‹åŒ– ---
            function initGame() {
                // é‡ç½®ç‹€æ…‹
                idiomList.innerHTML = '';
                definitionList.innerHTML = '';
                selectedIdiom = null;
                selectedDefinition = null;
                matchedCount = 0;
                resultModal.classList.add('hidden');
                resultModal.firstElementChild.classList.add('scale-95');

                // å»ºç«‹æˆèªåˆ—è¡¨ (å›ºå®šé †åº)
                const idioms = [...gameData];
                idioms.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item.idiom;
                    li.dataset.id = item.id;
                    li.className = 'game-card';
                    li.addEventListener('click', onIdiomClick);
                    idiomList.appendChild(li);
                });

                // å»ºç«‹è§£é‡‹åˆ—è¡¨ (éš¨æ©Ÿé †åº)
                const definitions = shuffle([...gameData]);
                definitions.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item.definition;
                    li.dataset.id = item.id;
                    li.className = 'game-card';
                    li.addEventListener('click', onDefinitionClick);
                    definitionList.appendChild(li);
                });
            }

            // --- 6. é»æ“Šäº‹ä»¶è™•ç† ---
            function onIdiomClick(e) {
                const clickedCard = e.target;
                if (clickedCard.classList.contains('matched')) return;

                // å¦‚æœå·²ç¶“é¸äº†ä¸€å€‹ï¼Œå…ˆå–æ¶ˆ
                if (selectedIdiom) {
                    selectedIdiom.classList.remove('selected');
                }
                
                // å¦‚æœé»æ“Šçš„æ˜¯åŒä¸€å€‹ï¼Œå‰‡å–æ¶ˆé¸å–
                if (selectedIdiom === clickedCard) {
                    selectedIdiom = null;
                } else {
                    clickedCard.classList.add('selected');
                    selectedIdiom = clickedCard;
                }
                
                checkMatch();
            }

            function onDefinitionClick(e) {
                const clickedCard = e.target;
                if (clickedCard.classList.contains('matched')) return;

                if (selectedDefinition) {
                    selectedDefinition.classList.remove('selected');
                }
                
                if (selectedDefinition === clickedCard) {
                    selectedDefinition = null;
                } else {
                    clickedCard.classList.add('selected');
                    selectedDefinition = clickedCard;
                }

                checkMatch();
            }

            // --- 7. æª¢æŸ¥é…å° ---
            function checkMatch() {
                if (!selectedIdiom || !selectedDefinition) return;

                const idiomId = selectedIdiom.dataset.id;
                const definitionId = selectedDefinition.dataset.id;

                if (idiomId === definitionId) {
                    // --- é…å°æˆåŠŸ ---
                    selectedIdiom.classList.remove('selected');
                    selectedDefinition.classList.remove('selected');
                    
                    selectedIdiom.classList.add('matched');
                    selectedDefinition.classList.add('matched');

                    // ç§»é™¤äº‹ä»¶ç›£è½å™¨
                    selectedIdiom.removeEventListener('click', onIdiomClick);
                    selectedDefinition.removeEventListener('click', onDefinitionClick);

                    selectedIdiom = null;
                    selectedDefinition = null;
                    matchedCount++;

                    // æª¢æŸ¥æ˜¯å¦éŠæˆ²çµæŸ
                    if (matchedCount === totalPairs) {
                        setTimeout(showWinModal, 500);
                    }

                } else {
                    // --- é…å°éŒ¯èª¤ ---
                    const tempIdiom = selectedIdiom;
                    const tempDefinition = selectedDefinition;

                    tempIdiom.classList.add('wrong');
                    tempDefinition.classList.add('wrong');
                    
                    selectedIdiom = null;
                    selectedDefinition = null;

                    setTimeout(() => {
                        tempIdiom.classList.remove('wrong');
                        tempDefinition.classList.remove('wrong');
                        tempIdiom.classList.remove('selected');
                        tempDefinition.classList.remove('selected');
                    }, 800);
                }
            }

            // --- 8. é¡¯ç¤ºå‹åˆ©å½ˆçª— ---
            function showWinModal() {
                resultModal.classList.remove('hidden');
                setTimeout(() => {
                    resultModal.firstElementChild.classList.remove('scale-95');
                }, 10); // å»¶é²ä¸€é»ä»¥è§¸ç™¼ transition
            }

            // --- 9. èƒŒæ™¯éŸ³æ¨‚ ---
            let musicPlaying = false;
            const synth = new Tone.PolySynth(Tone.Synth, {
                oscillator: { type: "triangle" },
                envelope: { attack: 0.02, decay: 0.1, sustain: 0.3, release: 1 }
            }).toDestination();
            
            const reverb = new Tone.Reverb(1.5).toDestination();
            synth.connect(reverb);

            const notes = ["C4", "E4", "G4", "A4", "C5", "A4", "G4", "E4"];
            let noteIndex = 0;
            
            const musicLoop = new Tone.Loop(time => {
                const note = notes[noteIndex % notes.length];
                synth.triggerAttackRelease(note, "8n", time);
                noteIndex++;
            }, "4n"); // æ¯ 4 åˆ†éŸ³ç¬¦æ’­æ”¾ä¸€æ¬¡

            musicBtn.addEventListener('click', async () => {
                await Tone.start();
                if (musicPlaying) {
                    Tone.Transport.stop();
                    musicLoop.stop();
                    musicPlaying = false;
                    musicBtn.classList.remove('bg-red-500', 'hover:bg-red-600');
                    musicBtn.classList.add('bg-purple-600', 'hover:bg-purple-700');
                } else {
                    Tone.Transport.start();
                    musicLoop.start(0);
                    musicPlaying = true;
                    musicBtn.classList.remove('bg-purple-600', 'hover:bg-purple-700');
                    musicBtn.classList.add('bg-red-500', 'hover:bg-red-600');
                }
            });

            // --- 10. äº‹ä»¶ç¶å®š ---
            resetBtn.addEventListener('click', initGame);
            closeModalBtn.addEventListener('click', () => {
                resultModal.classList.add('hidden');
                resultModal.firstElementChild.classList.add('scale-95');
                // ä¹Ÿå¯ä»¥åœ¨é€™è£¡è‡ªå‹•é‡ç½®éŠæˆ²
                initGame();
            });

            // --- 11. å•Ÿå‹•éŠæˆ² ---
            initGame();

        });
    </script>
</body>
</html>
